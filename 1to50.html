<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1 to 50</title>
    <style>
      table {
        border-spacing: 5px;
        border-collapse: separate;
      }

      td {
        width: 70px;
        height: 70px;
        text-align: center;
        font-size: 30px;
        font-family: "Roboto";
        font-weight: bold;
        color: white;
        background-color: rgb(70, 104, 167);
      }

      .clicked {
        animation: move 0.2s ease-in-out;
        background-color: rgb(51, 77, 126);
      }

      @keyframes move {
        0% {
          background-color: white;
        }

        100% {
          background-color: rgb(62, 95, 156);
        }
      }

      .blank {
        background-color: white;
      }

      .result {
        font-size: 30px;
        font-family: "Roboto";
        font-weight: bold;
      }
    </style>
  </head>

  <body>
    <script>
      const { body } = document;
      const $table = document.createElement("table"); // 게임판 생성
      const $result = document.createElement("div"); // 게임시간 생성
      $result.className = "result";
      let timeId; // 타이머 Id

      const numbers = Array(50) // 1~50 까지의 숫자로된 배열
        .fill()
        .map(
          // 1 부터 50까지의 숫자 배열 생성
          (e, i) => i + 1
        );

      const shuffledNumbers = []; //[0]~[24] = 셔플된 1~25, [25]~[49] = 셔플된 26~50
      function shuffle() {
        // 숫자 랜덤하게 섞기
        while (numbers.length > 0) {
          const randIdx = Math.floor(Math.random() * numbers.length);
          if (numbers[randIdx] <= 25) {
            // 랜덤한 숫자가 25 이하 일때
            shuffledNumbers.unshift(numbers.splice(randIdx, 1)); // 배열 앞에서 삽입
          } else {
            // 랜덤한 숫자가 26 이상 일때
            shuffledNumbers.push(numbers.splice(randIdx, 1)); // 배열 뒤에서 삽입
          }
        }
      }

      function startTimer() {
        //타이머 시작
        const startTime = new Date(); // 게임 시작할때 시간
        timeId = setInterval(() => {
          let runTime = new Date(); // 게임 진행 시간
          let playTime = new Date(runTime - startTime); // 현재 게임 시간
          $result.textContent = `${playTime.getSeconds()}.${playTime.getMilliseconds()}`;
        });
      }

      function stopTimer() {
        //타이머 종료
        clearInterval(timeId);
      }

      let timeFlag = false; // 타이머 플래그
      let currentNumber = 1; // 현재 눌러야할 숫자
      function onNumberClick(event) {
        // 숫자 클릭했을때
        const ClickedNumber = event.target.textContent;
        if (ClickedNumber == currentNumber) {
          //클릭한 숫자와 현재 눌러야할 숫자가 같을때
          if (!timeFlag) {
            // 타이머 실행
            timeFlag = true;
            startTimer();
          }
          if (ClickedNumber == 50) {
            // 마지막 숫자를 눌렀을 때
            stopTimer();
          }
          event.target.classList.toggle("clicked"); // 클릭 했을때 배경색 변경
          event.target.textContent = shuffledNumbers[currentIdx];
          currentNumber++;
          currentIdx++;
          if (ClickedNumber > 25) {
            // 더이상 나올 숫자가 없을때
            event.target.classList.toggle("blank");
          }
        }
      }

      let currentIdx = 0; // 현재 shuffledNumber 배열 위치
      const createTable = () => {
        // 게임 판 생성
        shuffle();
        for (i = 0; i < 5; i++) {
          // table tr 만들기
          const $tr = document.createElement("tr");
          for (j = 0; j < 5; j++) {
            // table td 만들기
            const $td = document.createElement("td");
            $td.textContent = shuffledNumbers[currentIdx];
            $tr.appendChild($td);
            currentIdx++;
          }
          $table.appendChild($tr);
          $table.addEventListener("click", onNumberClick);
        }
      };
      createTable();
      body.prepend($result);
      body.prepend($table);
    </script>
  </body>
</html>
